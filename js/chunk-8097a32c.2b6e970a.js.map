{"version":3,"sources":["webpack:///./src/service/race.js","webpack:///./src/service/team.js","webpack:///./src/views/Vote.vue?13bf","webpack:///./src/assets/js/wxpop.js","webpack:///src/views/Vote.vue","webpack:///./src/views/Vote.vue?2671","webpack:///./src/views/Vote.vue","webpack:///./src/views/Vote.vue?71b3"],"names":["getTop100","achieve_id","$next","get","getTopTotal","achieve_arr","params","ids","getLives","event_id","doVote","team_id","post","getMyTeams","getAllTeams","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","vote_title_img","_m","_l","item","i","key","_v","_s","_f","logo","name","server","votes","class","disabled","clicked","on","$event","vote","staticRenderFns","getWechatIframe","url","encodeURIComponent","location","href","redirect_uri","component"],"mappings":"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","file":"js/chunk-8097a32c.2b6e970a.js","sourcesContent":["import { $next } from \"./axios\";\n\nfunction getTop100(achieve_id) {\n    return $next.get(`team/race/achieve/${achieve_id}/top100`);\n}\n\nfunction getTopTotal(achieve_arr) {\n    return $next.get(`team/race/achieve/finish/process`, {\n        params: {\n            ids: achieve_arr,\n            // _no_cache\n        },\n    });\n}\n\nfunction getLives(event_id, params) {\n    return $next.get(`team/rank/events/${event_id}/live-tv-list`, {\n        params: params,\n    });\n}\n\nfunction doVote(event_id, team_id) {\n    return $next.post(`team/events/${event_id}/vote-team/${team_id}`);\n}\n\nexport { getTop100, getLives, getTopTotal, doVote };\n","import { $next } from \"./axios\";\n\nfunction getMyTeams() {\n    return $next.get(\"team/my-team\");\n}\n\nfunction getAllTeams(event_id,params) {\n    return $next.get(`team/rank/events/${event_id}/all-teams`,{\n        params : params\n    });\n}\n\nexport { getMyTeams, getAllTeams };\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-rank-vote\"},[_c('div',{staticClass:\"m-rank-vote-title\"},[_c('img',{attrs:{\"src\":_vm.vote_title_img}})]),_vm._m(0),_c('table',{staticClass:\"m-rank-vote-table\"},[_vm._m(1),_c('tbody',_vm._l((_vm.data),function(item,i){return _c('tr',{key:i},[_c('td',[_c('i',{staticClass:\"u-ranking\"},[_vm._v(_vm._s(i + 1))])]),_c('td',[_c('a',{attrs:{\"href\":_vm._f(\"teamLink\")(item.team_id),\"target\":\"_blank\"}},[_c('img',{staticClass:\"u-logo\",attrs:{\"loading\":\"lazy\",\"src\":_vm._f(\"teamLogo\")(item.logo),\"alt\":item.name}})])]),_c('td',[_c('a',{staticClass:\"u-name\",attrs:{\"href\":_vm._f(\"teamLink\")(item.team_id),\"target\":\"_blank\"}},[_vm._v(\" \"+_vm._s(item.name)+\" \")])]),_c('td',[_c('span',{staticClass:\"u-server\"},[_vm._v(_vm._s(item.server))])]),_c('td',[_c('span',{staticClass:\"u-count\"},[_vm._v(_vm._s(item.votes))])]),_c('td',{staticClass:\"u-vote-wapper\"},[_c('button',{staticClass:\"u-vote\",class:{disabled:item.clicked},on:{\"click\":function($event){return _vm.vote(item)}}})])])}),0)])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-rank-vote-header\"},[_c('div',{staticClass:\"u-tip\"},[_c('i',{staticClass:\"el-icon-info\"}),_vm._v(\" 规则说明：需\"),_c('a',{attrs:{\"href\":\"/account/login/\",\"target\":\"_blank\"}},[_vm._v(\"登录\")]),_vm._v(\"并有\"),_c('a',{attrs:{\"href\":\"/dashboard/#/connect\",\"target\":\"_blank\"}},[_vm._v(\"绑定微信\")]),_vm._v(\"的用户方可投票，每天可给3支不同团队各投1票。10月29日开启通道，结榜后关闭通道。 \")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',[_c('tr',[_c('th',{attrs:{\"width\":\"120px\"}},[_vm._v(\"排名\")]),_c('th',{attrs:{\"width\":\"120px\"}}),_c('th',{attrs:{\"width\":\"120px\"}},[_vm._v(\"团队\")]),_c('th',[_vm._v(\"服务器\")]),_c('th',[_vm._v(\"票数\")]),_c('th',[_vm._v(\"参与投票\")])])])}]\n\nexport { render, staticRenderFns }","function getWechatIframe(){\n    let url = encodeURIComponent(encodeURIComponent(location.href))\n    let redirect_uri = 'https://server.jx3box.com/oauth/wechat/callback' + '?skip=' + url\n    return `<iframe class=\"m-rank-pop-wechat\" src=\"https://open.weixin.qq.com/connect/qrconnect?appid=wx7804c72000d28202&redirect_uri=${redirect_uri}&response_type=code&scope=snsapi_login&state=jx3box#wechat_redirect\"></iframe>\n    <p class=\"m-rank-pop-wechat-tips\"><i class=\"el-icon-warning-outline\"></i> 如绑定后仍提示绑定界面请重新登录</p>`\n}\n\nexport default getWechatIframe","<template>\n    <div class=\"m-rank-vote\">\n        <div class=\"m-rank-vote-title\">\n            <img :src=\"vote_title_img\" />\n        </div>\n        <div class=\"m-rank-vote-header\">\n            <div class=\"u-tip\">\n                <i class=\"el-icon-info\"></i> 规则说明：需<a\n                    href=\"/account/login/\"\n                    target=\"_blank\"\n                    >登录</a\n                >并有<a href=\"/dashboard/#/connect\" target=\"_blank\">绑定微信</a\n                >的用户方可投票，每天可给3支不同团队各投1票。10月29日开启通道，结榜后关闭通道。\n            </div>\n        </div>\n        <table class=\"m-rank-vote-table\">\n            <thead>\n                <tr>\n                    <th width=\"120px\">排名</th>\n                    <th width=\"120px\"></th>\n                    <th width=\"120px\">团队</th>\n                    <th>服务器</th>\n                    <th>票数</th>\n                    <th>参与投票</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr v-for=\"(item, i) in data\" :key=\"i\">\n                    <td>\n                        <i class=\"u-ranking\">{{ i + 1 }}</i>\n                    </td>\n                    <td>\n                        <a :href=\"item.team_id | teamLink\" target=\"_blank\">\n                        <img\n                            loading=\"lazy\"\n                            class=\"u-logo\"\n                            :src=\"item.logo | teamLogo\"\n                            :alt=\"item.name\"\n                        />\n                        </a>\n                    </td>\n                    <td>\n                        <a\n                            class=\"u-name\"\n                            :href=\"item.team_id | teamLink\"\n                            target=\"_blank\"\n                        >\n                            {{ item.name }}\n                        </a>\n                    </td>\n                    <td>\n                        <span class=\"u-server\">{{ item.server }}</span>\n                    </td>\n                    <td>\n                        <span class=\"u-count\">{{ item.votes }}</span>\n                    </td>\n                    <td class=\"u-vote-wapper\">\n                        <button\n                            class=\"u-vote\"\n                            :class=\"{disabled:item.clicked}\"\n                            @click=\"vote(item)\"\n                        ></button>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</template>\n\n<script>\nimport { __imgPath,default_avatar } from \"@jx3box/jx3box-common/js/jx3box.json\";\nimport { getAllTeams } from \"@/service/team.js\";\nimport { getThumbnail } from \"@jx3box/jx3box-common/js/utils\";\nimport { doVote } from \"@/service/race.js\";\nimport User from \"@jx3box/jx3box-common/js/user.js\";\nimport getWechatIframe from '@/assets/js/wxpop.js'\nexport default {\n    props: [],\n    data: function() {\n        return {\n            vote_title_img: __imgPath + \"image/rank/common/vote.png\",\n            data: [],\n            isLogin: User.isLogin(),\n            dialog_visible : false\n        };\n    },\n    computed: {\n        id: function() {\n            return this.$store.state.id;\n        },\n    },\n    methods: {\n        vote: function(item) {\n\n            // 检查登录\n            if (!this.isLogin) {\n                User.toLogin();\n                return;\n            }\n\n            // 检查微信\n            if (!User.hasBindwx()) {\n                this.$alert(getWechatIframe(), \"提示\", {\n                    confirmButtonText: \"确定\",\n                    dangerouslyUseHTMLString: true,\n                });\n                return\n            }\n\n            doVote(this.id, item.team_id).then((res) => {\n                this.$message({\n                    message: \"投票成功\",\n                    type: \"success\",\n                    duration: 1000,\n                });\n\n                item.clicked = true\n                item.votes = ~~item.votes + 1\n                this.$forceUpdate()\n                \n            });\n            \n        },\n    },\n    filters: {\n        teamLogo: function(val) {\n            return val ? getThumbnail(val, 48, true) : default_avatar;\n        },\n        teamLink: function(val) {\n            return \"/team/#/org/view/\" + val;\n        },\n    },\n    created: function() {\n        getAllTeams(this.id, {\n            orderBy: \"votes\",\n        }).then((res) => {\n            this.data = res.data.data.list;\n        });\n    },\n    mounted : function (){\n        let params = this.$route.query\n        if(params.bind_wx){\n            User.refresh('bind_wx',params.bind_wx)\n        }\n    },\n    components: {},\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/race_vote.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Vote.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Vote.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Vote.vue?vue&type=template&id=6110d47b&\"\nimport script from \"./Vote.vue?vue&type=script&lang=js&\"\nexport * from \"./Vote.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Vote.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Vote.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Vote.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}