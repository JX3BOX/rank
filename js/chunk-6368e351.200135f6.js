(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6368e351"],{"04b5":function(t,e,n){"use strict";n("d1d8")},1450:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("41cb");function i(){return Object(a["e"])().get("/api/team/my-team")}},"365d":function(t,e,n){"use strict";var a=n("65c2"),i={LOGO:a["__imgPath"]+"image/rank/common/logo.png",cover:function(t){return a["__imgPath"]+"image/rank/cover/".concat(t,".png")},boss:function(t){return a["__imgPath"]+"image/rank/race/".concat(t,"/boss.png")},version:function(t){return a["__imgPath"]+"image/rank/race/".concat(t,"/version.png")},logos:function(t){return a["__imgPath"]+"image/rank/logos/"+t+".png"},bossIcon:function(t){return a["__imgPath"]+"image/rank/boss/".concat(t,".png")}};e["a"]=i},3891:function(t,e,n){"use strict";n.r(e);n("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-rank-container",attrs:{id:"app"}},[e("Header"),e("div",{staticClass:"m-rank-primary"},[e("div",{staticClass:"m-rank-join"},[e("div",{staticClass:"m-rank-header"},[e("a",{attrs:{href:"/rank",target:"_blank"}},[e("img",{staticClass:"u-logo",attrs:{src:t.LOGO}})])]),t.isLogin?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-rank-content"},[e("div",{staticClass:"m-join m-join-team"},[e("h1",{staticClass:"m-join-title"},[t._v("报名入口")]),e("div",{staticClass:"m-join-notice",domProps:{innerHTML:t._s(t.notice)}}),t.loading||t.status?t._e():e("el-form",{ref:"form",staticClass:"m-join-form",attrs:{model:t.form,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"报名活动"}},[e("el-select",{attrs:{placeholder:"请选择活动"},model:{value:t.form.event_id,callback:function(e){t.$set(t.form,"event_id",e)},expression:"form.event_id"}},t._l(t.events,(function(t){return e("el-option",{key:t.ID,attrs:{label:t.name,value:t.ID}})})),1)],1),e("el-form-item",{attrs:{label:"选择团队"}},[e("el-select",{attrs:{placeholder:"请选择团队"},on:{change:t.updateTeam},model:{value:t.form.team_id,callback:function(e){t.$set(t.form,"team_id",e)},expression:"form.team_id"}},t._l(t.teams,(function(n){return e("el-option",{key:n.ID,attrs:{label:n.name,value:n.ID}},[e("span",{staticClass:"m-join-team-item"},[e("b",{staticClass:"u-team-name"},[t._v(t._s(n.name))]),e("span",{staticClass:"u-team-id"},[t._v("(ID:"+t._s(n.ID)+")")]),e("span",{staticClass:"u-team-server"},[t._v(t._s(n.server))])])])})),1),t.teams&&t.teams.length?t._e():e("div",{staticClass:"u-tip"},[t._v(" 还没有团队？"),e("a",{attrs:{href:"/team",target:"_blank"}},[t._v("创建团队")])])],1),e("el-form-item",{attrs:{label:"参赛宣言"}},[e("el-input",{attrs:{placeholder:"为您的团队打CALL,将显示在游戏内",maxlength:20,"show-word-limit":""},model:{value:t.form.slogan,callback:function(e){t.$set(t.form,"slogan",e)},expression:"form.slogan"}})],1),e("div",{staticClass:"u-btns"},[e("el-button",{staticClass:"u-btn",attrs:{type:"primary",disabled:!t.ready},on:{click:t.submit}},[t._v("报名")])],1)],1),t.status?e("div",{staticClass:"m-join m-join-done"},[e("h1",{staticClass:"u-title",class:t.statusText[t.audit_status].class},[t._v(" "+t._s(t.statusText[t.audit_status].name)+" ")]),e("div",[e("p",[t._v(" 活动："),e("strong",[t._v(t._s(t.result.event.name))])]),e("p",[t._v(" 团队："),e("strong",[t._v(t._s(t.result.eventRecord.name))])])])]):t._e()],1),t._m(0)]):e("div",{staticClass:"m-rank-content m-rank-null"},[e("p",[t._v("你尚未登录")]),e("el-button",{attrs:{type:"primary"},on:{click:t.goLogin}},[t._v("登录")])],1)])]),e("Footer"),e("bindWxMp",{on:{update:t.onBindWxMpUpdate},model:{value:t.showBindWxMp,callback:function(e){t.showBindWxMp=e},expression:"showBindWxMp"}})],1)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-footer"},[e("a",{attrs:{href:"/notice/32280",target:"_blank"}},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("b",[t._v("点击查看百强活动细则")])])])}],s=n("b85c"),o=(n("d3b7"),n("159b"),n("2ef0"),n("365d")),r=n("d087"),c=n("a440"),u=n("1450"),l=n("c9d2"),d=n("cc9a"),m=n("524f"),f=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"绑定微信公众号",visible:t.visible,width:"30%","custom-class":"m-notice-wechat__dialog","before-close":t.handleClose}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-wechat-content"},[t.ticket?e("el-image",{staticClass:"u-qr",attrs:{src:t.qrcodeValue,lazy:""}},[e("div",{staticClass:"u-error",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e(),e("i",{staticClass:"u-tip"},[t._v("打开微信扫一扫，关注剑三魔盒公众号")]),e("el-button",{staticClass:"u-btn",attrs:{type:"success",size:"small"},on:{click:t.confirm}},[t._v("我已绑定")])],1)])},v=[],p=(n("99af"),n("41cb"));function h(){return Object(p["a"])().get("/api/cms/wechat/mp/bind")}var _="https://mp.weixin.qq.com/cgi-bin/showqrcode",b={name:"BindWxMp",data:function(){return{ticket:"",loading:!1}},props:{visible:{type:Boolean,default:!1}},model:{prop:"visible",event:"update:visible"},computed:{qrcodeValue:function(){return"".concat(_,"?ticket=").concat(encodeURIComponent(this.ticket))}},watch:{visible:function(t){t&&this.loadQrcode()}},methods:{loadQrcode:function(){var t=this;this.loading=!0,h().then((function(e){var n;t.ticket=null===(n=e.data.data)||void 0===n?void 0:n.ticket})).finally((function(){t.loading=!1}))},handleClose:function(){this.$emit("update:visible",!1)},confirm:function(){this.$emit("update"),this.$emit("update:visible",!1)}}},g=b,k=(n("04b5"),n("2877")),j=Object(k["a"])(g,f,v,!1,null,null,null),C=j.exports,y={name:"App",props:[],data:function(){return{LOGO:o["a"].LOGO,form:{event_id:"",team_id:"",slogan:""},events:[],teams:[],loading:!0,status:!1,audit_status:0,statusText:[{name:"待审核",class:"u-orange"},{name:"已报名",class:""}],joined_team_name:"",isLogin:l["a"].isLogin(),result:{event:{name:"活动名称"},eventRecord:{name:"团队名称"}},processing:!1,notice:"",profile:null,showBindWxMp:!1}},computed:{ready:function(){return this.form.event_id&&this.form.team_id&&this.form.slogan&&!this.status&&!this.processing},event_id:function(){return this.form.event_id},team_name:function(){var t,e=this.form.team_id,n="",a=Object(s["a"])(this.teams);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.ID==e){n=i.name;break}}}catch(o){a.e(o)}finally{a.f()}return n},isWechatVerified:function(){var t;return!(null===(t=this.profile)||void 0===t||!t.wechat_mp_openid)}},methods:{submit:function(){var t=this;this.isWechatVerified?this.$alert("报名后资料将不可再更改，更多咨询请联系认证团长Q群【1048059072】","消息",{confirmButtonText:"确定",callback:function(e){"confirm"==e&&(t.processing=!0,Object(c["b"])(t.form).then((function(e){t.$message({message:"报名成功,请等待审核",type:"success"}),t.status=!0,t.audit_status=e.data.data.status||0,t.joined_team_name=t.team_name,t.$forceUpdate()})).finally((function(){t.processing=!1})))}}):this.$alert("请先绑定微信公众号，再进行报名","消息",{confirmButtonText:"去绑定",callback:function(e){"confirm"==e&&(t.showBindWxMp=!0)}})},updateTeam:function(){var t=this;this.teams.forEach((function(e){e.ID==t.form.team_id&&(t.result.eventRecord.name=e.name)}))},loadEvents:function(){var t=this;return Object(r["b"])({status:1}).then((function(e){t.events=e.data.data.list||[],t.form.event_id=t.events[0].ID||t.event_id,t.$forceUpdate()}))},loadTeams:function(){var t=this;return Object(u["a"])().then((function(e){t.teams=e.data.data.list||[],t.form.team_id=t.team_id,t.$forceUpdate()}))},checkJoin:function(){var t=this;this.form.event_id&&Object(c["a"])(this.form.event_id).then((function(e){t.result=e.data.data,e.data.data.hasJoined&&(t.audit_status=e.data.data.eventRecord.status,2!=t.audit_status&&(t.status=!0,t.joined_team_name=e.data.data.eventRecord.name,t.$forceUpdate())),t.loading=!1}))},goLogin:function(){l["a"].toLogin()},loadNotice:function(){var t=this;Object(d["a"])("rank-join").then((function(e){t.notice=e}))},init:function(){this.loadUser(),this.loadEvents(),this.loadTeams(),this.loadNotice()},loadUser:function(){var t=this;this.isLogin&&Object(m["b"])().then((function(e){t.profile=e.data.data}))},onBindWxMpUpdate:function(){this.loadUser()}},watch:{event_id:function(t){this.checkJoin()}},created:function(){this.isLogin&&this.init()},components:{BindWxMp:C}},w=y,x=(n("8497"),Object(k["a"])(w,a,i,!1,null,null,null));e["default"]=x.exports},"44cf":function(t,e,n){},"524f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("41cb");function i(t){return Object(a["e"])().get("/api/team/team-gift-record/list/public",{params:t})}function s(){return Object(a["a"])().get("/api/cms/user/my/info",{params:{__no_cache:1}})}},8497:function(t,e,n){"use strict";n("44cf")},a440:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));var a=n("41cb");function i(t){return Object(a["e"])().post("/api/team/rank/join",t)}function s(t,e){return Object(a["e"])().get("/api/team/rank/my-records",{params:{event_id:t}})}},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d28b"),n("d9e2"),n("d3b7"),n("3ca3"),n("ddb0");var a=n("06c5");function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){c=!0,o=t},f:function(){try{r||null==n["return"]||n["return"]()}finally{if(c)throw o}}}}},d087:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("41cb");function i(t){return Object(a["e"])().get("/api/team/rank/events/"+t)}function s(t){return Object(a["e"])().get("/api/team/rank/events",{params:t})}},d1d8:function(t,e,n){}}]);
//# sourceMappingURL=chunk-6368e351.200135f6.js.map