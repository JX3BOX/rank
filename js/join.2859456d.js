(function(t){function e(e){for(var a,o,r=e[0],c=e[1],u=e[2],d=0,f=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==i[c]&&(a=!1)}a&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},i={join:0},s=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="https://cdn.jx3box.com/static/rank/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=c;s.push([3,"chunk-vendors"]),n()})({"2fcd":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=n("5c96"),s=n.n(i),o=n("6a69"),r=(n("6b30"),n("c5b4"),n("16e5")),c=(n("b0c0"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-rank-container",attrs:{id:"app"}},[e("Header"),e("div",{staticClass:"m-rank-primary"},[e("div",{staticClass:"m-rank-join"},[e("div",{staticClass:"m-rank-header"},[e("a",{attrs:{href:"/rank",target:"_blank"}},[e("img",{staticClass:"u-logo",attrs:{src:t.LOGO}})])]),t.isLogin?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-rank-content"},[e("div",{staticClass:"m-join m-join-team"},[e("h1",{staticClass:"m-join-title"},[t._v("报名入口")]),e("div",{staticClass:"m-join-notice",domProps:{innerHTML:t._s(t.notice)}}),t.loading||t.status?t._e():e("el-form",{ref:"form",staticClass:"m-join-form",attrs:{model:t.form,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"报名活动"}},[e("el-select",{attrs:{placeholder:"请选择活动","no-data-text":"暂无活动"},model:{value:t.form.event_id,callback:function(e){t.$set(t.form,"event_id",e)},expression:"form.event_id"}},t._l(t.events,(function(t){return e("el-option",{key:t.ID,attrs:{label:t.name,value:t.ID}})})),1)],1),e("el-form-item",{attrs:{label:"选择团队"}},[e("el-select",{attrs:{placeholder:"请选择团队"},on:{change:t.updateTeam},model:{value:t.form.team_id,callback:function(e){t.$set(t.form,"team_id",e)},expression:"form.team_id"}},t._l(t.teams,(function(n){return e("el-option",{key:n.ID,attrs:{label:n.name,value:n.ID}},[e("span",{staticClass:"m-join-team-item"},[e("b",{staticClass:"u-team-name"},[t._v(t._s(n.name))]),e("span",{staticClass:"u-team-id"},[t._v("(ID:"+t._s(n.ID)+")")]),e("span",{staticClass:"u-team-server"},[t._v(t._s(n.server))])])])})),1),t.teams&&t.teams.length?t._e():e("div",{staticClass:"u-tip"},[t._v(" 还没有团队？"),e("a",{attrs:{href:"/team",target:"_blank"}},[t._v("创建团队")])])],1),e("el-form-item",{attrs:{label:"参赛宣言"}},[e("el-input",{attrs:{placeholder:"为您的团队打CALL,将显示在游戏内",maxlength:20,"show-word-limit":""},model:{value:t.form.slogan,callback:function(e){t.$set(t.form,"slogan",e)},expression:"form.slogan"}})],1),e("div",{staticClass:"u-btns"},[e("el-button",{staticClass:"u-btn",attrs:{type:"primary",disabled:!t.ready},on:{click:t.submit}},[t._v("报名")])],1)],1),t.status?e("div",{staticClass:"m-join m-join-done"},[e("h1",{staticClass:"u-title",class:t.statusText[t.audit_status].class},[t._v(" "+t._s(t.statusText[t.audit_status].name)+" ")]),e("div",[e("p",[t._v(" 活动："),e("strong",[t._v(t._s(t.result.event.name))])]),e("p",[t._v(" 团队："),e("strong",[t._v(t._s(t.result.eventRecord.name))])])])]):t._e()],1),t._m(0)]):e("div",{staticClass:"m-rank-content m-rank-null"},[e("p",[t._v("你尚未登录")]),e("el-button",{attrs:{type:"primary"},on:{click:t.goLogin}},[t._v("登录")])],1)])]),e("Footer"),e("bindWxMp",{on:{update:t.onBindWxMpUpdate},model:{value:t.showBindWxMp,callback:function(e){t.showBindWxMp=e},expression:"showBindWxMp"}})],1)}),u=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-footer"},[e("a",{attrs:{href:"/notice/32280",target:"_blank"}},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("b",[t._v("点击查看百强活动细则")])])])}],l=n("b85c"),d=(n("d3b7"),n("159b"),n("2ef0"),n("365d")),f=n("d087"),m=n("41cb");function p(t){return Object(m["e"])().post("/api/team/rank/join",t)}function v(t,e){return Object(m["e"])().get("/api/team/rank/my-records",{params:{event_id:t}})}function h(){return Object(m["e"])().get("/api/team/my-team")}var b=n("c9d2"),_=n("cc9a"),g=n("524f"),k=n("bcca"),y={name:"App",props:[],data:function(){return{LOGO:d["a"].LOGO,form:{event_id:"",team_id:"",slogan:""},events:[],teams:[],loading:!1,status:!1,audit_status:0,statusText:[{name:"待审核",class:"u-orange"},{name:"已报名",class:""}],joined_team_name:"",isLogin:b["a"].isLogin(),result:{event:{name:"活动名称"},eventRecord:{name:"团队名称"}},processing:!1,notice:"",profile:null,showBindWxMp:!1}},computed:{ready:function(){return this.form.event_id&&this.form.team_id&&this.form.slogan&&!this.status&&!this.processing},event_id:function(){return this.form.event_id},team_name:function(){var t,e=this.form.team_id,n="",a=Object(l["a"])(this.teams);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.ID==e){n=i.name;break}}}catch(s){a.e(s)}finally{a.f()}return n},isWechatVerified:function(){var t;return!(null===(t=this.profile)||void 0===t||!t.wechat_mp_openid)}},methods:{submit:function(){var t=this;this.isWechatVerified?this.$alert("报名后资料将不可再更改，更多咨询请联系认证团长Q群【1048059072】","消息",{confirmButtonText:"确定",callback:function(e){"confirm"==e&&(t.processing=!0,p(t.form).then((function(e){t.$message({message:"报名成功,请等待审核",type:"success"}),t.status=!0,t.audit_status=e.data.data.status||0,t.joined_team_name=t.team_name,t.$forceUpdate()})).finally((function(){t.processing=!1})))}}):this.$alert("请先绑定微信公众号，再进行报名","消息",{confirmButtonText:"去绑定",callback:function(e){"confirm"==e&&(t.showBindWxMp=!0)}})},updateTeam:function(){var t=this;this.teams.forEach((function(e){e.ID==t.form.team_id&&(t.result.eventRecord.name=e.name)}))},loadEvents:function(){var t=this;return Object(f["b"])({status:1}).then((function(e){var n;t.events=e.data.data.list||[],t.form.event_id=(null===(n=t.events[0])||void 0===n?void 0:n.ID)||t.event_id,t.$forceUpdate()}))},loadTeams:function(){var t=this;return h().then((function(e){t.teams=e.data.data.list||[],t.form.team_id=t.team_id,t.$forceUpdate()}))},checkJoin:function(){var t=this;this.form.event_id&&(this.loading=!0,v(this.form.event_id).then((function(e){t.result=e.data.data,e.data.data.hasJoined&&(t.audit_status=e.data.data.eventRecord.status,2!=t.audit_status&&(t.status=!0,t.joined_team_name=e.data.data.eventRecord.name,t.$forceUpdate())),t.loading=!1})))},goLogin:function(){b["a"].toLogin()},loadNotice:function(){var t=this;Object(_["a"])("rank-join").then((function(e){t.notice=e}))},init:function(){this.loadUser(),this.loadEvents(),this.loadTeams(),this.loadNotice()},loadUser:function(){var t=this;this.isLogin&&Object(g["b"])().then((function(e){t.profile=e.data.data}))},onBindWxMpUpdate:function(){this.loadUser()}},watch:{event_id:function(t){this.checkJoin()}},created:function(){this.isLogin&&this.init()},components:{BindWxMp:k["a"]}},j=y,O=(n("931e"),n("2877")),x=Object(O["a"])(j,c,u,!1,null,null,null),w=x.exports;a["default"].config.productionTip=!1,a["default"].use(s.a),a["default"].use(o["a"]),r["a"].install(a["default"]),new a["default"]({render:function(t){return t(w)}}).$mount("#app")},3:function(t,e,n){t.exports=n("2fcd")},"35ef":function(t,e,n){},"365d":function(t,e,n){"use strict";var a=n("65c2"),i={LOGO:a["__imgPath"]+"image/rank/common/logo.png",cover:function(t){return a["__imgPath"]+"image/rank/cover/".concat(t,".png")},boss:function(t){return a["__imgPath"]+"image/rank/race/".concat(t,"/boss.png")},version:function(t){return a["__imgPath"]+"image/rank/race/".concat(t,"/version.png")},logos:function(t){return a["__imgPath"]+"image/rank/logos/"+t+".png"},bossIcon:function(t){return a["__imgPath"]+"image/rank/boss/".concat(t,".png")}};e["a"]=i},"524f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("41cb");function i(t){return Object(a["e"])().get("/api/team/team-gift-record/list/public",{params:t})}function s(){return Object(a["a"])().get("/api/cms/user/my/info",{params:{__no_cache:1}})}},"55e8":function(t,e,n){},"7cb7":function(t,e,n){var a={"./bilibili.svg":"175f","./douyu.svg":"b119","./github.svg":"bffd","./huya.svg":"046a","./msg.svg":"aa9d","./weibo.svg":"50b5"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="7cb7"},"931e":function(t,e,n){"use strict";n("55e8")},bcca:function(t,e,n){"use strict";var a=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"绑定微信公众号",visible:t.visible,width:"30%","custom-class":"m-notice-wechat__dialog","before-close":t.handleClose,"append-to-body":""}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-wechat-content"},[t.ticket?e("el-image",{staticClass:"u-qr",attrs:{src:t.qrcodeValue,lazy:""}},[e("div",{staticClass:"u-error",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e(),e("i",{staticClass:"u-tip"},[t._v("打开微信扫一扫，关注剑三魔盒公众号")]),e("el-button",{staticClass:"u-btn",attrs:{type:"success",size:"small"},on:{click:t.confirm}},[t._v("我已绑定")])],1)])},i=[],s=(n("99af"),n("d3b7"),n("41cb"));function o(){return Object(s["a"])().get("/api/cms/wechat/mp/bind")}var r="https://mp.weixin.qq.com/cgi-bin/showqrcode",c={name:"BindWxMp",data:function(){return{ticket:"",loading:!1}},props:{visible:{type:Boolean,default:!1}},model:{prop:"visible",event:"update:visible"},computed:{qrcodeValue:function(){return"".concat(r,"?ticket=").concat(encodeURIComponent(this.ticket))}},watch:{visible:function(t){t&&this.loadQrcode()}},methods:{loadQrcode:function(){var t=this;this.loading=!0,o().then((function(e){var n;t.ticket=null===(n=e.data.data)||void 0===n?void 0:n.ticket})).finally((function(){t.loading=!1}))},handleClose:function(){this.$emit("update:visible",!1)},confirm:function(){this.$emit("update"),this.$emit("update:visible",!1)}}},u=c,l=(n("e42b"),n("2877")),d=Object(l["a"])(u,a,i,!1,null,null,null);e["a"]=d.exports},d087:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("41cb");function i(t){return Object(a["e"])().get("/api/team/rank/events/"+t)}function s(t){return Object(a["e"])().get("/api/team/rank/events",{params:t})}},e42b:function(t,e,n){"use strict";n("35ef")}});
//# sourceMappingURL=join.2859456d.js.map