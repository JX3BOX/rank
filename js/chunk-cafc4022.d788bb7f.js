(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cafc4022"],{"13d5":function(t,i,e){"use strict";var s=e("23e7"),a=e("d58f").left,n=e("a640"),o=e("2d00"),r=e("605d"),c=!r&&o>79&&o<83,l=c||!n("reduce");s({target:"Array",proto:!0,forced:l},{reduce:function(t){var i=arguments.length;return a(this,t,i,i>1?arguments[1]:void 0)}})},"40a4":function(t,i,e){"use strict";e.r(i);e("a15b");var s=function(){var t=this,i=t._self._c;return i("div",{staticClass:"m-lover-join m-lover-page wp"},[i("div",{staticClass:"u-page-title"},[i("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"join-title.png")}})]),t.success?[i("div",{staticClass:"m-success"},[i("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"success.svg")}}),i("span",[t._v("报名成功，你的报名信息如下")])])]:t._e(),t.isLogin?[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-lover-box m-lover-certificate"},[t.list.length?[t.certificate?[i("certificate",{attrs:{data:t.certificate}}),t.join?t._e():i("div",{staticClass:"u-button",on:{click:t.setLover}},[t._v("设定为主情缘")])]:i("div",{staticClass:"no-certificate"},[t._v("ღ 暂无绑定的主情缘 ღ")])]:t.loading?t._e():i("div",{staticClass:"no-certificate"},[t._v("ღ 请按教程在游戏内绑定情缘 ღ")])],2),t.join?t._e():i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-lover-list"},t._l(t.list,(function(e,s){return i("div",{key:e.id,staticClass:"m-lover-box",on:{click:function(i){return t.changeLover(s)}}},[i("div",{staticClass:"u-user"},[i("div",{staticClass:"u-avatar"},[i("el-avatar",{staticClass:"u-avatar-pic",attrs:{shape:"circle",size:30,src:e.user_info_1.avatar}})],1),i("span",{staticClass:"u-name"},[t._v(t._s(e.user_info_1.display_name))])]),i("div",{staticClass:"u-user"},[i("div",{staticClass:"u-avatar"},[i("el-avatar",{staticClass:"u-avatar-pic",attrs:{shape:"circle",size:30,src:e.user_info_2.avatar}})],1),i("span",{staticClass:"u-name"},[t._v(t._s(e.user_info_2.display_name))])])])})),0),t.entry?i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-lover-box m-lover-enroll"},[i("h3",[t._v("情缘杯报名")]),i("el-form",{ref:"form",class:["m-lover-form",{disabled:t.join}],attrs:{disabled:t.join,model:t.form,rules:t.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"队伍名",prop:"team_name"}},[i("el-input",{model:{value:t.form.team_name,callback:function(i){t.$set(t.form,"team_name",t._n(i))},expression:"form.team_name"}})],1),i("el-form-item",{attrs:{label:"参赛宣言",prop:"slogan"}},[i("el-input",{attrs:{type:"textarea",rows:2},model:{value:t.form.slogan,callback:function(i){t.$set(t.form,"slogan",i)},expression:"form.slogan"}})],1),i("el-form-item",{attrs:{label:"合照上传"}},[i("uploadImage",{attrs:{"max-size":30},model:{value:t.form.image,callback:function(i){t.$set(t.form,"image",i)},expression:"form.image"}})],1)],1),i("div",{class:["u-submit",{disabled:t.join}],on:{click:t.toJoin}},[i("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"join.png")}})])],1):t._e()]:i("div",{staticClass:"m-lover-box no-login"},[i("h3",[t._v("请登录后进行报名")]),i("div",{staticClass:"u-button",on:{click:t.toLogin}},[t._v("点击登录")])])],2)},a=[],n=e("ade3"),o=(e("4de4"),e("d3b7"),e("c9d2")),r=e("b11b"),c=e("85e4"),l=(e("13d5"),function(){var t=this,i=t._self._c;return i("div",[i("el-upload",{ref:"upload",attrs:{action:"https://cms.jx3box.com/api/cms/upload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,"file-list":t.fileList,limit:t.maxCount,accept:t.acceptedExtensions.reduce((function(t,i){return t+".".concat(i,",")}),""),multiple:"","with-credentials":"","on-exceed":t.onExceed,"on-change":t.onChange,"on-success":t.onSuccess,"on-error":t.onError}},[i("i",{staticClass:"el-icon-plus"}),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 最多上传 "+t._s(t.maxCount)+" 张 "+t._s(t.acceptedExtensions.join(" / ").toUpperCase())+" 格式图片，单张图片不能超过 "+t._s(t.maxSize/1024/1024)+" MB ")])]),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(i){t.dialogVisible=i}}},[i("img",{attrs:{width:"60%",src:t.dialogImageUrl,alt:""}})])],1)}),u=[],d=(e("99af"),e("a9e3"),{props:{fileMaxSize:{type:Number,default:10}},data:function(){return{dialogImageUrl:"",dialogVisible:!1,fileList:[],successList:[],acceptedExtensions:["jpg","jpeg","png","gif"],maxCount:5,maxSize:1024*this.fileMaxSize*1024}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onExceed:function(){this.$notify({title:"",message:"最多上传 ".concat(this.maxCount," 张图片！"),type:"error",duration:3e3,position:"bottom-right"})},onChange:function(t,i){"ready"==t.status&&(t.size>this.maxSize?(this.$notify({title:"",message:"单张图片大小不能超过 ".concat(this.maxSize/1024/1024," MB！"),type:"error",duration:3e3,position:"bottom-right"}),i.pop()):this.fileList=i)},upload:function(){this.fileList.length>0?this.$refs.upload.submit():this.$emit("onFinish",[])},onSuccess:function(t){this.successList=this.successList.concat(t.data),this.successList.length==this.fileList.length&&(this.$emit("onFinish",this.successList||[]),this.fileList=[],this.successList=[])},onError:function(){this.$notify({title:"",message:"图片上传失败!",type:"error",duration:3e3,position:"bottom-right"}),this.$emit("onError"),this.fileList=[]}}}),m=d,f=e("2877"),v=Object(f["a"])(m,l,u,!1,null,null,null),p=v.exports,g=function(){var t=this,i=t._self._c;return i("div",{staticClass:"m-certificate"},[t._v("情缘证")])},h=[],_={name:"certificate",props:{data:{type:Object,default:function(){}}},data:function(){return{}},computed:{},methods:{}},b=_,x=Object(f["a"])(b,g,h,!1,null,null,null),C=x.exports,y={name:"LoverJoin",inject:["__imgRoot"],components:{certificate:C,uploadImage:p},data:function(){return{loading:!1,lover:!1,isLogin:o["a"].isLogin(),list:[],form:Object(n["a"])(Object(n["a"])({team_name:"",images:[],lover_jx3id:"",phone:"",qq:"",remark:"",server:"",slogan:""},"team_name",""),"user_jx3id",""),rules:{team_name:[{required:!0,message:"请输入队伍名",trigger:"blur"}]},certificate:null,join:!1,entry:!1,success:!1}},computed:{loverId:function(){return this.$store.state.loverId},myJoin:function(){return this.$store.state.my_join||null}},watch:{isLogin:{immediate:!0,handler:function(t){t&&(this.loadMyLover(),this.$store.dispatch("getMyEventStatus"))}},join:function(t){t&&(this.entry=!0)},myJoin:{immediate:!0,handler:function(t){null!==t&&void 0!==t&&t.id&&(this.form=val,this.join=!0,this.entry=!0)}}},methods:{authorLink:c["a"],toLogin:function(){o["a"].toLogin()},loadMyLover:function(){var t=this;this.loading=!0,Object(r["e"])().then((function(i){var e=i.data.data.list||[];t.list=e,t.certificate=e.filter((function(t){return 1===t.star}))[0]||null})).finally((function(){t.loading=!1}))},changeLover:function(t){this.certificate=this.list[t]},setLover:function(){var t=this;Object(r["g"])(this.certificate.id).then((function(){t.entry=!0,t.$notify({title:"主情缘设置成功",type:"success"})}))},toJoin:function(){var t=this;this.join||Object(r["f"])(this.form).then((function(){t.join=!0,t.success=!0,t.$notify({title:"报名成功",type:"success"})}))}}},j=y,L=(e("c880"),Object(f["a"])(j,s,a,!1,null,null,null));i["default"]=L.exports},c880:function(t,i,e){"use strict";e("f06b")},d58f:function(t,i,e){"use strict";var s=e("59ed"),a=e("7b0b"),n=e("44ad"),o=e("07fa"),r=TypeError,c="Reduce of empty array with no initial value",l=function(t){return function(i,e,l,u){var d=a(i),m=n(d),f=o(d);if(s(e),0===f&&l<2)throw new r(c);var v=t?f-1:0,p=t?-1:1;if(l<2)while(1){if(v in m){u=m[v],v+=p;break}if(v+=p,t?v<0:f<=v)throw new r(c)}for(;t?v>=0:f>v;v+=p)v in m&&(u=e(u,m[v],v,d));return u}};t.exports={left:l(!1),right:l(!0)}},f06b:function(t,i,e){}}]);
//# sourceMappingURL=chunk-cafc4022.d788bb7f.js.map